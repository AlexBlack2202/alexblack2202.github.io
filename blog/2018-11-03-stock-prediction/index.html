<!doctype html><html lang="en" data-palette="blue"
   data-mode="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>D·ª± ƒëo√°n ch·ª©ng kho√°n s·ª≠ d·ª•ng tensorflow - Ph·∫°m Duy T√πng Machine Learning Blog</title>
    <meta name="a.validate.02" content="1QZXZ8oi7g57H-GxBrBPkTYBydwii-Ic9iJu" /><link rel="apple-touch-icon" href="/images/icons/icon-180x180.png" sizes="180x180">
<link rel="icon" href="/images/icons/icon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/images/icons/icon-16x16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/images/icons/favicon.ico">
<link rel="manifest" href="/manifest.json">
<meta name="keywords" content="" />
<meta name="description" content="·ªû b√†i vi·∫øt n√†y, ch√∫ng ta ƒë·ªÅ c·∫≠p ƒë·∫øn v·∫•n ƒë·ªÅ s·ª≠ d·ª•ng tensorflow ƒë·ªÉ d·ª± ƒëo√°n ch·ªâ s·ªë S&amp;P 500." /><meta name="robots" content="index, follow" />
  <meta itemprop="name" content="D·ª± ƒëo√°n ch·ª©ng kho√°n s·ª≠ d·ª•ng tensorflow">
  <meta itemprop="description" content="·ªû b√†i vi·∫øt n√†y, ch√∫ng ta ƒë·ªÅ c·∫≠p ƒë·∫øn v·∫•n ƒë·ªÅ s·ª≠ d·ª•ng tensorflow ƒë·ªÉ d·ª± ƒëo√°n ch·ªâ s·ªë S&amp;P 500.">
  <meta itemprop="datePublished" content="2018-11-03T00:19:00+03:00">
  <meta itemprop="dateModified" content="2018-11-03T00:19:00+03:00">
  <meta itemprop="wordCount" content="1083">
  <meta itemprop="keywords" content="Machine Learning,Deep Learning,Stock Prediction"><meta property="og:url" content="/blog/2018-11-03-stock-prediction/">
  <meta property="og:site_name" content="Ph·∫°m Duy T√πng Machine Learning Blog">
  <meta property="og:title" content="D·ª± ƒëo√°n ch·ª©ng kho√°n s·ª≠ d·ª•ng tensorflow">
  <meta property="og:description" content="·ªû b√†i vi·∫øt n√†y, ch√∫ng ta ƒë·ªÅ c·∫≠p ƒë·∫øn v·∫•n ƒë·ªÅ s·ª≠ d·ª•ng tensorflow ƒë·ªÉ d·ª± ƒëo√°n ch·ªâ s·ªë S&amp;P 500.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2018-11-03T00:19:00+03:00">
    <meta property="article:modified_time" content="2018-11-03T00:19:00+03:00">
    <meta property="article:tag" content="Machine Learning">
    <meta property="article:tag" content="Deep Learning">
    <meta property="article:tag" content="Stock Prediction">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="D·ª± ƒëo√°n ch·ª©ng kho√°n s·ª≠ d·ª•ng tensorflow">
  <meta name="twitter:description" content="·ªû b√†i vi·∫øt n√†y, ch√∫ng ta ƒë·ªÅ c·∫≠p ƒë·∫øn v·∫•n ƒë·ªÅ s·ª≠ d·ª•ng tensorflow ƒë·ªÉ d·ª± ƒëo√°n ch·ªâ s·ªë S&amp;P 500.">
<meta property="og:image" content="/images/logo.png"/>
  <meta name="twitter:image" content="/images/logo.png"/><link rel="stylesheet" href="/css/main.min.c06cf34535ee1f60ba08893b4d57e76b2bbd5e11c17ab12ef976f02983a51b54.css" integrity="sha256-wGzzRTXuH2C6CIk7TVfnayu9XhHBerEu&#43;XbwKYOlG1Q=" crossorigin="anonymous"><link rel="stylesheet" href="/css/katex.min.d080a89e03e1eb850f547d835c186b4273f69879aa497eb8b0e88c1578bf1f0b.css" integrity="sha256-0ICongPh64UPVH2DXBhrQnP2mHmqSX64sOiMFXi/Hws=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/viewer.min.3d228794bcedbbfa0412beb8fbc1ec6973202945e42af7004f742a4d7bd620ab.css" integrity="sha256-PSKHlLztu/oEEr64&#43;8HsaXMgKUXkKvcAT3QqTXvWIKs=" crossorigin="anonymous"><style>
    .bgcover {
        display: block;
        overflow: hidden;
        height: 450px;
        background: no-repeat center center;
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
        position: relative;
        margin-bottom: -65px;
    }
    .bgcover {
        margin-bottom: 0 !important;
    }

    .bgcover .bgtrans {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        display: block;
        overflow: hidden;
        height: inherit;
        background: rgba(0,0,0,.8);
        background: -webkit-gradient(linear,0% 0%,0% 100%,from(rgba(0,0,0,.8)),to (rgba(0,0,0,.6)),to(rgba(255,255,255,0)));
        background: -webkit-linear-gradient(top,rgba(255,255,255,0),rgba(0,0,0,.6),rgba(0,0,0,.8));
        background: -moz-linear-gradient(top,rgba(255,255,255,0),rgba(0,0,0,.6),rgba(0,0,0,.8));
        background: -ms-linear-gradient(top,rgba(255,255,255,0),rgba(0,0,0,.6),rgba(0,0,0,.8));
        background: -o-linear-gradient(top,rgba(255,255,255,0),rgba(0,0,0,.6),rgba(0,0,0,.8));
    }

    .bgcover .bgtrans h1 {
        display: block;
        overflow: hidden;
        font-size: 45px;
        line-height: 55px;
        color: #fff;
        width: 800px;
        margin: auto;
        position: absolute;
        left: 0;
        right: 0;
        bottom: 50px;
        font-family: 'Roboto Condensed',sans-serif;
        font-weight: 600;
    }
</style></head>
  <body><script>const items=["mode","palette"];items.forEach(function(e){const t=localStorage.getItem("hbs-"+e);t&&document.body.parentElement.setAttribute("data-"+e,t)})</script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button><a class="navbar-brand flex-grow-1 flex-lg-grow-0 text-center text-lg-start mx-auto me-lg-3" href="/"><img class="logo" alt="Logo" src="/images/logo.webp" loading="lazy"  title="Logo"
   width="32" height="32"
   />
HOME
    </a>
    <div class="offcanvas offcanvas-bottom surface" tabindex="-1" id="offcanvasSocialShare" aria-labelledby="offcanvasSocialShare">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Share</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=D%e1%bb%b1%20%c4%91o%c3%a1n%20ch%e1%bb%a9ng%20kho%c3%a1n%20s%e1%bb%ad%20d%e1%bb%a5ng%20tensorflow&url=%2fblog%2f2018-11-03-stock-prediction%2f">
      <i class="fab fa-fw fa-twitter"></i> Twitter
    </a>
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button"
      target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=%2fblog%2f2018-11-03-stock-prediction%2f">
      <i class="fab fa-fw fa-facebook-f"></i> Facebook
    </a>
  </div>
</div>
    <button class="navbar-settings" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSettings"
  aria-controls="offcanvasSettings" aria-label="Toggle settings">
  <i class="fas fa-ellipsis-v"></i>
</button>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings" aria-labelledby="offcanvasSettings">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Settings</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body d-flex flex-column">



<section class="setting">
  <form class="font-size-switcher-form row">
    <div class="col-auto">
      <label for="fontSize" class="form-label"><i class="fas fa-fw fa-font"></i> Font Size</label>
    </div>
    <div class="col-auto ms-auto">
      <input type="range" class="form-range" min="-2" max="2" id="fontSize">
    </div>
  </form>
</section>


<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <a id="btnPalette" class="btn btn-sm btn-outline-primary" role="button" aria-label="palettePicker">
        <i class="fas fa-eye-dropper"></i>
      </a>
    </div>
  </form>
  <div class="mt-2 d-flex justify-content-between visually-hidden" id="palettePicker"><button type="button" id="palette-blue" aria-label="Blue"
        class="btn btn-sm w-100 palette" data-palette="blue">
      </button><button type="button" id="palette-blue-gray" aria-label="Blue Gray"
        class="btn btn-sm w-100 palette" data-palette="blue-gray">
      </button><button type="button" id="palette-brown" aria-label="Brown"
        class="btn btn-sm w-100 palette" data-palette="brown">
      </button><button type="button" id="palette-cyan" aria-label="Cyan"
        class="btn btn-sm w-100 palette" data-palette="cyan">
      </button><button type="button" id="palette-green" aria-label="Green"
        class="btn btn-sm w-100 palette" data-palette="green">
      </button><button type="button" id="palette-indigo" aria-label="Indigo"
        class="btn btn-sm w-100 palette" data-palette="indigo">
      </button><button type="button" id="palette-orange" aria-label="Orange"
        class="btn btn-sm w-100 palette" data-palette="orange">
      </button><button type="button" id="palette-pink" aria-label="Pink"
        class="btn btn-sm w-100 palette" data-palette="pink">
      </button><button type="button" id="palette-purple" aria-label="Purple"
        class="btn btn-sm w-100 palette" data-palette="purple">
      </button><button type="button" id="palette-red" aria-label="Red"
        class="btn btn-sm w-100 palette" data-palette="red">
      </button><button type="button" id="palette-teal" aria-label="Teal"
        class="btn btn-sm w-100 palette" data-palette="teal">
      </button><button type="button" id="palette-yellow" aria-label="Yellow"
        class="btn btn-sm w-100 palette" data-palette="yellow">
      </button></div>
</section>
<section class="setting actions d-flex justify-content-around mt-auto overflow-auto">
  <a role="button" class="action action-go-back" href="javascript: window.history.back();">
    <span class="action-icon"><i class="fas fa-2x fa-arrow-left"></i></span> Go back
  </a>
  <a role="button" class="action action-reload-page">
    <span class="action-icon"><i class="fas fa-2x fa-redo-alt"></i></span> Reload
  </a>
  <a role="button" class="action action-copy-url">
    <span class="action-icon"><i class="fas fa-2x fa-link"></i></span> Copy URL
  </a><a class="action action-social-share" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSocialShare"
    aria-controls="offcanvasSocialShare" aria-label="Toggle social share">
    <span class="action-icon"><i class="fas fa-2x fa-share-alt"></i></span> Share
  </a></section>

</div>
</div>

    <div class="collapse navbar-collapse" tabindex="-1" id="navbarSupportedContent" aria-labelledby="navbarSupportedContent">
      <form class="search-bar my-1" action="/search">
  <div class="input-group input-group-sm">
    <span class="btn btn-search disabled position-absolute left-0"><i class="fas fa-fw fa-search"></i></span>
    <input class="form-control rounded-pill" name="q" type="search" aria-label="Search">
  </div>
</form>
      <ul class="navbar-nav ms-auto"><li class="nav-item">
          <a class="nav-link" href="/series/">
            <i class="fas fa-fw fa-columns"></i>Courses
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tools/">
            <i class="fas fa-fw fa-folder"></i>Tools
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/categories/">
            <i class="fas fa-fw fa-folder"></i>Categories
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/archives/">
            <i class="fas fa-fw fa-file-archive"></i>Archives
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tags/">
            <i class="fas fa-fw fa-tags"></i>Tags
          </a>
        </li><li class="nav-item dropdown">
          <a class="nav-link" id="navbarDropdownSupport" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-fw fa-chevron-circle-down"></i>Support
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownSupport"><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Repository
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Discussions
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Features Request
              </a>
            </li><li><hr class="dropdown-divider"></li><li>
              <a class="dropdown-item"
                href="/faq/">
                FAQs
              </a>
            </li></ul>
        </li></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container" style="line-height:1.7em">
      <div class="row content">
<div class="col-lg-9 col-md-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body">
    <ol class="breadcrumb "><li class="breadcrumb-item"><a href="/">Home</a></li><li class="breadcrumb-item"><a href="/blog/">Blogs</a></li><li class="breadcrumb-item active">D·ª± ƒêo√°n Ch·ª©ng Kho√°n S·ª≠ D·ª•ng Tensorflow</li></ol>
  </div>
</nav>
<div class="post-panel-wrapper">
  <div class="d-flex flex-column component rounded post-panel">
    
    <a class="action action-panel-toggler" role="button" title="Panel toggler">
      <i class="fas fa-fw fa-chevron-circle-down"></i>
    </a>
    <a id="sidebarToggler" class="action d-none d-lg-block" role="button" title="Sidebar toggler">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>

    

    
    
    <a class="action" href="#post-comments" role="button" aria-label="Comments" title="Comments">
  <i class="fas fa-fw fa-comments"></i>
</a>
    <a class="action" href="#postTOC" aria-controls="Table of contents" role="button" title="Table of contents">
  <i class="fas fa-fw fa-list-alt"></i>
</a>
    
  </div>
</div>
<article class="row card component mb-4 post">
  <div class="card-header ">
    <div class="bgcover" style="background-image:url(https://unsplash.it/1920/1080)" alt="D·ª± ƒëo√°n ch·ª©ng kho√°n s·ª≠ d·ª•ng tensorflow">
      <div class="bgtrans">
          <h1>D·ª± ƒêo√°n Ch·ª©ng Kho√°n S·ª≠ D·ª•ng Tensorflow
</h1>
      </div>
  </div>
</div>
  <div class="card-body"><div class="post-meta">
  <span class="post-date" title="created on 2018-11-03 04:19:00 &#43;0700 &#43;07.">
    Nov 3, 2018
  </span><span class="post-reading-time">
    6 min read
  </span><span class="post-taxonomies"><a href="/tags/machine-learning/" class="badge post-taxonomy">Machine learning</a><a href="/tags/deep-learning/" class="badge post-taxonomy">Deep learning</a><a href="/tags/stock-prediction/" class="badge post-taxonomy">stock prediction</a></span>
</div>
<div class="post-content mb-3"><div class="toc">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#l·ªùi-m·ªü-ƒë·∫ßu">L·ªùi m·ªü ƒë·∫ßu</a></li>
    <li><a href="#d·∫´n-nh·∫≠p">D·∫´n nh·∫≠p</a>
      <ul>
        <li><a href="#ph√¢n-t√≠ch-d·ªØ-li·ªáu">Ph√¢n t√≠ch d·ªØ li·ªáu</a></li>
        <li><a href="#ph√¢n-chia-t·∫≠p-train-v√†-test">Ph√¢n chia t·∫≠p train v√† test.</a></li>
        <li><a href="#scale-d·ªØ-li·ªáu">Scale d·ªØ li·ªáu</a></li>
        <li><a href="#x√¢y-d·ª±ng-m√¥-h√¨nh-s·ª≠-d·ª•ng-keras">X√¢y d·ª±ng m√¥ h√¨nh s·ª≠ d·ª•ng keras</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
<h1 id="l·ªùi-m·ªü-ƒë·∫ßu">L·ªùi m·ªü ƒë·∫ßu<a class="anchor ms-1" href="#l·ªùi-m·ªü-ƒë·∫ßu"><i class="fas fa-link"></i></a></h1>
<p>·ªû b√†i vi·∫øt n√†y, m√¨nh s·∫Ω x√¢y d·ª±ng m√¥ h√¨nh h∆°n gi·∫£n ƒë·ªÉ √°p d·ª•ng v√†o t·∫≠p d·ªØ li·ªáu gi√° ch·ª©ng kho√°n. M·ª•c ti√™u c·ªßa b√†i n√†y l√† ch√∫ng ta s·∫Ω d·ª± ƒëo√°n ch·ªâ s·ªë S&amp;P 500 d·ª±a tr√™n ch·ªâ s·ªë c·ªßa 500 m√£ ch·ª©ng kho√°n. C√°c b·∫°n c√≥ nhu c·∫ßu t√¨m hi·ªÉu th√™m v·ªÅ ch·ªâ s·ªë sp 500 c√≥ th·ªÉ ƒë·ªçc th√™m ·ªü <a href="https://vi.wikipedia.org/wiki/S%26P_500" target="_blank" rel="noopener noreferrer">https://vi.wikipedia.org/wiki/S%26P_500</a>. ƒê√¢y l√† m·ªôt ·ª©ng d·ª•ng nh·ªè, kh√¥ng c√≥ √Ω nghƒ©a nhi·ªÅu ·ªü th·ª±c t·∫ø do khi ph√¢n t√≠ch ch·ª©ng kho√°n, ta c√≤n x√©t th√™m r·∫•t nhi·ªÅu y·∫øu t·ªë ph·ª• n·ªØa. M√¥ h√¨nh n√†y th·ª±c ch·∫•t ch·ªâ l√† m·ªôt trong nh·ªØng m√¥ h√¨nh ch∆°i ch∆°i.</p>
<h1 id="d·∫´n-nh·∫≠p">D·∫´n nh·∫≠p<a class="anchor ms-1" href="#d·∫´n-nh·∫≠p"><i class="fas fa-link"></i></a></h1>
<h2 id="ph√¢n-t√≠ch-d·ªØ-li·ªáu">Ph√¢n t√≠ch d·ªØ li·ªáu<a class="anchor ms-1" href="#ph√¢n-t√≠ch-d·ªØ-li·ªáu"><i class="fas fa-link"></i></a></h2>
<p>C√°c b·∫°n c√≥ th·ªÉ download d·ªØ li·ªáu ·ªü <a href="https://drive.google.com/open?id=1UTlj5Ced-yj6RBRVc6bBM6IWMjfQR3GR" target="_blank" rel="noopener noreferrer">https://drive.google.com/open?id=1UTlj5Ced-yj6RBRVc6bBM6IWMjfQR3GR</a>.</p>
<p>ƒê·∫ßu ti√™n, ch√∫ng ta s·∫Ω d√πng pandas ƒë·ªÉ load m√¥ h√¨nh l√™n:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="c1"># Import data</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_stocks.csv&#39;</span><span class="p">)</span>
</span></span></code></pre></div><p>Xem k√≠ch th∆∞·ªõc c·ªßa d·ªØ li·ªáu:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">(</span><span class="mi">41266</span><span class="p">,</span> <span class="mi">502</span><span class="p">)</span>
</span></span></code></pre></div><p>K·∫øt qu·∫£ l√† ta c√≥ h∆°n 40 ng√†n d√≤ng v√† 502 c·ªôt. Th·ª≠ show 10 row ƒë·∫ßu ti√™n c·ªßa d·ªØ li·ªáu l√™n xem nh∆∞ th·∫ø n√†o.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl">         <span class="n">DATE</span>      <span class="n">SP500</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">AAL</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">AAPL</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">ADBE</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">ADI</span>  \
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="mi">0</span>  <span class="mi">1491226200</span>  <span class="mf">2363.6101</span>     <span class="mf">42.3300</span>     <span class="mf">143.6800</span>     <span class="mf">129.6300</span>      <span class="mf">82.040</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="mi">1</span>  <span class="mi">1491226260</span>  <span class="mf">2364.1001</span>     <span class="mf">42.3600</span>     <span class="mf">143.7000</span>     <span class="mf">130.3200</span>      <span class="mf">82.080</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="mi">2</span>  <span class="mi">1491226320</span>  <span class="mf">2362.6799</span>     <span class="mf">42.3100</span>     <span class="mf">143.6901</span>     <span class="mf">130.2250</span>      <span class="mf">82.030</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="mi">3</span>  <span class="mi">1491226380</span>  <span class="mf">2364.3101</span>     <span class="mf">42.3700</span>     <span class="mf">143.6400</span>     <span class="mf">130.0729</span>      <span class="mf">82.000</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="mi">4</span>  <span class="mi">1491226440</span>  <span class="mf">2364.8501</span>     <span class="mf">42.5378</span>     <span class="mf">143.6600</span>     <span class="mf">129.8800</span>      <span class="mf">82.035</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">   <span class="n">NASDAQ</span><span class="o">.</span><span class="n">ADP</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">ADSK</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">AKAM</span>  <span class="n">NASDAQ</span><span class="o">.</span><span class="n">ALXN</span>    <span class="o">...</span>     <span class="n">NYSE</span><span class="o">.</span><span class="n">WYN</span>  \
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="mi">0</span>    <span class="mf">102.2300</span>      <span class="mf">85.2200</span>       <span class="mf">59.760</span>       <span class="mf">121.52</span>    <span class="o">...</span>       <span class="mf">84.370</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="mi">1</span>    <span class="mf">102.1400</span>      <span class="mf">85.6500</span>       <span class="mf">59.840</span>       <span class="mf">121.48</span>    <span class="o">...</span>       <span class="mf">84.370</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="mi">2</span>    <span class="mf">102.2125</span>      <span class="mf">85.5100</span>       <span class="mf">59.795</span>       <span class="mf">121.93</span>    <span class="o">...</span>       <span class="mf">84.585</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="mi">3</span>    <span class="mf">102.1400</span>      <span class="mf">85.4872</span>       <span class="mf">59.620</span>       <span class="mf">121.44</span>    <span class="o">...</span>       <span class="mf">84.460</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="mi">4</span>    <span class="mf">102.0600</span>      <span class="mf">85.7001</span>       <span class="mf">59.620</span>       <span class="mf">121.60</span>    <span class="o">...</span>       <span class="mf">84.470</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">   <span class="n">NYSE</span><span class="o">.</span><span class="n">XEC</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">XEL</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">XL</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">XOM</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">XRX</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">XYL</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">YUM</span>  \
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="mi">0</span>   <span class="mf">119.035</span>     <span class="mf">44.40</span>    <span class="mf">39.88</span>     <span class="mf">82.03</span>      <span class="mf">7.36</span>     <span class="mf">50.22</span>     <span class="mf">63.86</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="mi">1</span>   <span class="mf">119.035</span>     <span class="mf">44.11</span>    <span class="mf">39.88</span>     <span class="mf">82.03</span>      <span class="mf">7.38</span>     <span class="mf">50.22</span>     <span class="mf">63.74</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="mi">2</span>   <span class="mf">119.260</span>     <span class="mf">44.09</span>    <span class="mf">39.98</span>     <span class="mf">82.02</span>      <span class="mf">7.36</span>     <span class="mf">50.12</span>     <span class="mf">63.75</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="mi">3</span>   <span class="mf">119.260</span>     <span class="mf">44.25</span>    <span class="mf">39.99</span>     <span class="mf">82.02</span>      <span class="mf">7.35</span>     <span class="mf">50.16</span>     <span class="mf">63.88</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="mi">4</span>   <span class="mf">119.610</span>     <span class="mf">44.11</span>    <span class="mf">39.96</span>     <span class="mf">82.03</span>      <span class="mf">7.36</span>     <span class="mf">50.20</span>     <span class="mf">63.91</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl">   <span class="n">NYSE</span><span class="o">.</span><span class="n">ZBH</span>  <span class="n">NYSE</span><span class="o">.</span><span class="n">ZTS</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="mi">0</span>   <span class="mf">122.000</span>    <span class="mf">53.350</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="mi">1</span>   <span class="mf">121.770</span>    <span class="mf">53.350</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="mi">2</span>   <span class="mf">121.700</span>    <span class="mf">53.365</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="mi">3</span>   <span class="mf">121.700</span>    <span class="mf">53.380</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="mi">4</span>   <span class="mf">121.695</span>    <span class="mf">53.240</span>
</span></span></code></pre></div><p>C·ªôt ƒë·∫ßu ti√™n l√† ng√†y, sau ƒë√≥ l√† m√£ ch·ª©ng kho√°n. Ch√∫ng ta c√≥ t·ªïng c·ªông 500 m√£ ch·ª©ng kho√°n v√† 1 ch·ªâ s·ªë. ƒê·ªÉ √Ω c·ªôt Date, ta th·∫•y gi√° tr·ªã ƒë·∫ßu ti√™n l√† 1491226200, gi√° tr·ªã th·ª© 2 l√† 1491226260, gi√° tr·ªã th·ª© 3 l√† 1491226320, m·ªói gi√° tr·ªã c√°ch nhau 60. Chuy·ªÉn ƒë·ªïi s·ªë 1491226200 sang d·∫°ng datetime th√¨ ra gi√° tr·ªã  Monday, April 3, 2017 1:30:00 PM gi·ªù GMT, t∆∞∆°ng t·ª± s·ªë 1491226260 ra Monday, April 3, 2017 1:31:00 PM gi·ªù GMT. Ta c√≥ th·ªÉ suy lu·∫≠n ra l√† gi√° tr·ªã giao d·ªãch l∆∞u theo t·ª´ng ph√∫t m·ªôt (kho·∫£ng interval l√† 60 gi√¢y), v√† d·ªØ li·ªáu ch√∫ng ta c√≥ b·∫Øt ƒë·∫ßu v√†o 3 th√°ng 4 nƒÉm 2017.</p>
<p>Plot ƒë·ªì th·ªã c·ªßa m√£ SP500 l√™n:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;SP500&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span></code></pre></div><p><img class="img-fluid" alt="H√¨nh ·∫£nh ƒë·ª´ng ƒë·ªì th·ªã c·ªßa ch·ªâ s·ªë sp 500" src="/blog/2018-11-03-stock-prediction/sp500index.png" loading="lazy"  title="H√¨nh ·∫£nh ƒë·ª´ng ƒë·ªì th·ªã c·ªßa ch·ªâ s·ªë sp 500"
  
   />

</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Notes: ·ªû ƒë√¢y c√≥ m·ªôt l∆∞u √Ω nh·ªè nh∆∞ng r·∫•t quan tr·ªçng. ƒê√≥ l√† t·∫°i th·ªùi ƒëi·ªÉm ph√∫t th·ª© t l∆∞u tr·ªØ gi√° tr·ªã sp500 c·ªßa th·ªùi ƒëi·ªÉm ph√∫t th·ª© t+1. V√≠ d·ª• v·ªõi ch·ªâ s·ªë sp500, d√≤ng ƒë·∫ßu ti√™n ta th·∫•y l√† 1491226200  2363.6101, nghƒ©a l√† gi√° th·ª±c t·∫ø c·ªßa th·ªùi ƒëi·ªÉm 1491226260 l√† 2363.6101. Do b√†i to√°n c·ªßa ch√∫ng ta l√† d·ªØ ƒëo√°n gi√° t∆∞∆°ng l·∫°i, n√™n t·∫°i th·ªùi ƒëi·ªÉm hi·ªán t·∫°i ta s·∫Ω d·ª± ƒëo√°n gi√° 1 ph√∫t sau s·∫Ω b·∫±ng bao nhi√™u. V√† t·∫≠p d·ªØ li·ªáu ƒë√£ t·ª± ƒë·ªông d·ªãch chuy·ªÉn gi√° tr·ªã l√™n 1 ph√∫t cho ch√∫ng ta ƒë·ª° m·∫•t c√¥ng l√†m. C√≤n gi√° c·ªßa 500 c·ªó phi·∫øu c√≤n l·∫°i v·∫´n l√† gi√° t·∫°i th·ªùi ƒëi·ªÉm t
</span></span></code></pre></div><h2 id="ph√¢n-chia-t·∫≠p-train-v√†-test">Ph√¢n chia t·∫≠p train v√† test.<a class="anchor ms-1" href="#ph√¢n-chia-t·∫≠p-train-v√†-test"><i class="fas fa-link"></i></a></h2>
<p>Ch√∫ng ta s·∫Ω chia d·ªØ li·ªáu th√†nh 2 ph·∫ßn v·ªõi 80% l√† train v√† 20% c√≤n l·∫°i l√† test. Do t√≠ch ch·∫•t c·ªßa d·ªØ li·ªáu l√† time serial n√™n ch√∫ng ta kh√¥ng th·ªÉ l√†m thay ƒë·ªïi th·ª© t·ª± d·ªØ li·ªáu.</p>
<p>Ch√∫ng ta s·∫Ω b·ªè ƒëi c·ªôt DATE ƒë·∫ßu ti√™n, v√† sau ƒë√≥ chuy·ªÉn d·ªØ li·ªáu v·ªÅ d·∫°ng numpy array ƒë·ªÉ d·ªÖ d√†ng th·ª±c hi·ªán c√°c ph√©p chuy·ªÉn ƒë·ªïi.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">data_</span> <span class="o">=</span> <span class="n">data_raw</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;DATE&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="n">data_</span><span class="o">.</span><span class="n">values</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"># Training and test data</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">train_start</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">train_end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.8</span><span class="o">*</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">test_start</span> <span class="o">=</span> <span class="n">train_end</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">test_end</span> <span class="o">=</span> <span class="n">n</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">data_train</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span> <span class="p">:</span><span class="n">train_end</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">data_test</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">train_end</span><span class="p">:]</span>
</span></span></code></pre></div><h2 id="scale-d·ªØ-li·ªáu">Scale d·ªØ li·ªáu<a class="anchor ms-1" href="#scale-d·ªØ-li·ªáu"><i class="fas fa-link"></i></a></h2>
<p>Khi s·ª≠ d·ª•ng ANN, ch√∫ng ta th√¥ng th∆∞·ªùng s·∫Ω scale d·ªØ li·ªáu input v·ªÅ ƒëo·∫°n [-1,1]. Trong python, th∆∞ vi·ªán sklearn ƒë√£ h·ªó tr·ª£ cho ch√∫ng ta s·∫µn c√°c h√†m scale d·ªØ li·ªáu c·∫ßn thi·∫øt.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Scale data</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="n">data_train</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_train</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">data_test</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data_test</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"># Build X and y</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">X_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">y_train</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">X_test</span> <span class="o">=</span> <span class="n">data_test</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">y_test</span> <span class="o">=</span> <span class="n">data_test</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</span></span></code></pre></div><p>M√¨nh c·∫ßn d·ª± ƒëo√°n gi√° tr·ªã c·ªßa ch·ªâ s·ªë sp 500, n√™n gi√° tr·ªã c·ªßa sp500 s·∫Ω l√† c√°i m√¨nh c·∫ßn d·ª± ƒëo√°n, ch√≠nh l√† c·ªôt ƒë·∫ßu ti√™n, c√≤n 500 c√°i c√≤n l·∫°i l√† input c·ªßa m√¨nh.</p>
<h2 id="x√¢y-d·ª±ng-m√¥-h√¨nh-s·ª≠-d·ª•ng-keras">X√¢y d·ª±ng m√¥ h√¨nh s·ª≠ d·ª•ng keras<a class="anchor ms-1" href="#x√¢y-d·ª±ng-m√¥-h√¨nh-s·ª≠-d·ª•ng-keras"><i class="fas fa-link"></i></a></h2>
<p>·ªû ƒë√¢y m√¨nh s·ª≠ d·ª•ng keras x√¢y d·ª±ng m√¥ h√¨nh ANN. M√¥ h√¨nh c·ªßa m√¨nh x√¢y d·ª±ng g·ªìm</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">from</span> <span class="nn">keras.layers.core</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Activation</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">ModelCheckpoint</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">from</span> <span class="nn">keras.optimizers</span> <span class="kn">import</span> <span class="n">SGD</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&#34;CUDA_DEVICE_ORDER&#34;</span><span class="p">]</span><span class="o">=</span><span class="s2">&#34;PCI_BUS_ID&#34;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"># The GPU id to use, usually either &#34;0&#34; or &#34;1&#34;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&#34;CUDA_VISIBLE_DEVICES&#34;</span><span class="p">]</span><span class="o">=</span><span class="s2">&#34;0&#34;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"># create model</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">input_dim</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="s1">&#39;my_model3.h5&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint</span><span class="p">],</span> <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</span></span></code></pre></div><p>Sau m·ªôt th·ªùi gian ch·∫°y, m√¨nh c≈©ng thu ƒë∆∞·ª£c model. C√°c b·∫°n quan t√¢m c√≥ th·ªÉ download model c·ªßa m√¨nh hu·∫•n luy·ªán ƒë∆∞·ª£c t·∫°i <a href="https://drive.google.com/open?id=1BLQZbcADfnLqzIHlkgpsqZBlhljBp1Eb" target="_blank" rel="noopener noreferrer">https://drive.google.com/open?id=1BLQZbcADfnLqzIHlkgpsqZBlhljBp1Eb</a> . Ti·∫øn h√†nh plot d·ªØ li·ªáu t·∫≠p test l√™n xem k·∫øt qu·∫£ nh∆∞ th·∫ø n√†o.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">yhat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">yhat</span><span class="p">))</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;real&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;mse: &#34;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">yhat</span><span class="p">)))</span>
</span></span></code></pre></div><p><img class="img-fluid" alt="h√¨nh ch·ª©ng kho√°n" src="/blog/2018-11-03-stock-prediction/chung_khoan_1.png" loading="lazy"  title="h√¨nh ch·ª©ng kho√°n"
  
   />

</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">mse</span><span class="p">:</span> <span class="mf">0.0014582120695331884</span>
</span></span></code></pre></div><p>K·∫øt qu·∫£ c·ªßa m√¥ h√¨nh t·∫°m ch·∫•p nh·∫≠n ƒë∆∞·ª£c, v·ªÅ h√¨nh d·∫°ng th√¨ kh√° t∆∞∆°ng ƒë·ªìng v·ªõi k·∫øt qu·∫£. Ch√∫ng ta c√≥ th·ªÉ c·∫£i ti·∫øn model b·∫±ng c√°ch n√¢ng s·ªë l∆∞·ª£ng layter/ hidden node, ho·∫∑c th√™m dropout. Ho·∫∑c c√≥ th·ªÉ thay th·∫ø m√¥ h√¨nh b·∫±ng RNN. Ch√∫ng ta s·∫Ω ƒë·ªÅ c·∫≠p ƒë·∫øn m√¥ h√¨nh RNN trong b√†i vi·∫øt sau.</p>
<p>C·∫£m ∆°n c√°c b·∫°n ƒë√£ theo d√µi. H·∫πn g·∫∑p b·∫°n ·ªü c√°c b√†i vi·∫øt ti·∫øp theo.</p>
</div></div>
  <div class="card-footer"><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev">
    <i class="fas fa-fw fa-chevron-left"></i>
    <a href="/blog/2018-11-01-overview-of-gradient-descent-optimization-algorithm/">Overview of Gradient Descent Optimization Algorithm
</a>
  </div><div class="post-nav post-next">
    <a href="/blog/2018-11-10-stock-prediction_lsmt/">D·ª± ƒêo√°n Gi√° Ch·ª©ng Kho√°n SP500 S·ª≠ D·ª•ng LSTM
</a>
    <i class="fas fa-fw fa-chevron-right"></i>
  </div></div></div>
</article><div class="card component row post-comments" id="post-comments">
  <div class="card-header">
    <h2 class="card-title">Comments</h2>
  </div>
  <div class="card-body"><script src="https://utteranc.es/client.js"
  repo="AlexBlack2202/utterances"
  issue-term="pathname"
  label="comment"
  theme="github-dark"
  crossorigin="anonymous"
  async>
</script></div>
</div></div>
</div><aside class="col-lg-3 col-md-4 sidebar d-flex">
  <div class="container d-flex flex-column">
    
    <a href="https://www.buymeacoffee.com/alexblack28"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=üçé&slug=alexblack28&button_colour=FFDD00&font_colour=000000&font_family=Cookie&outline_colour=000000&coffee_colour=ffffff" /></a><div class="post-toc row mb-4 card component" id="postTOC">
  <div class="card-header">
    <h2 class="card-title">Contents</h2>
  </div>
  <div class="card-body">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#l·ªùi-m·ªü-ƒë·∫ßu">L·ªùi m·ªü ƒë·∫ßu</a></li>
    <li><a href="#d·∫´n-nh·∫≠p">D·∫´n nh·∫≠p</a>
      <ul>
        <li><a href="#ph√¢n-t√≠ch-d·ªØ-li·ªáu">Ph√¢n t√≠ch d·ªØ li·ªáu</a></li>
        <li><a href="#ph√¢n-chia-t·∫≠p-train-v√†-test">Ph√¢n chia t·∫≠p train v√† test.</a></li>
        <li><a href="#scale-d·ªØ-li·ªáu">Scale d·ªØ li·ªáu</a></li>
        <li><a href="#x√¢y-d·ª±ng-m√¥-h√¨nh-s·ª≠-d·ª•ng-keras">X√¢y d·ª±ng m√¥ h√¨nh s·ª≠ d·ª•ng keras</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div><section class="recent-posts row card component">
  <div class="card-header">
    <h2 class="card-title">Recent Posts</h2>
  </div>
  <div class="card-body">
    <ul class="post-list"><li>
        <a href="/blog/2025-06-15-vllm-introduce/">Gi·ªõi Thi·ªáu VLLM -  C√¥ng C·ª• Ph·ª•c V·ª• LLM Hi·ªáu Su·∫•t Cao Cho ·ª®ng D·ª•ng AI
</a>
      </li><li>
        <a href="/blog/2025-06-14-vram-llm-recommend/">Dung L∆∞·ª£ng VRAM Cho Ng∆∞·ªùi D√πng Ph·ªï Th√¥ng Mu·ªën Ti·∫øp C·∫≠n LLM Ho·∫∑c Machine Learning
</a>
      </li><li>
        <a href="/blog/2025-06-13-bay-tai-chinh-tuoi-tre/">Gi·∫•c M∆° S·ªü H·ªØu Nh√† V√† C√°i B·∫´y T√†i Ch√≠nh C·ªßa Tu·ªïi Tr·∫ª
</a>
      </li><li>
        <a href="/blog/2025-06-12-prevent-bedtime-procrastination/">Ph√≤ng Ch·ªëng Vi·ªác Tr√¨ Ho√£n Gi·ªù ƒêi Ng·ªß (Prevent Bedtime Procrastination)
</a>
      </li><li>
        <a href="/blog/2025-04-29-etting-off-work-at-6-pm-is-already-quite-late/">Tan L√†m L√∫c 6 Gi·ªù T·ªëi ƒê√£ L√† Kh√° Mu·ªôn R·ªìi - Qu·∫£n L√Ω Th·ªùi Gian ‚Äì S·ªëng Tr·ªçn V·∫πn ‚Äì Quy·ªÅn ƒê∆∞·ª£c Ngh·ªâ Ng∆°i C·ªßa Ng∆∞·ªùi Tr·∫ª
</a>
      </li></ul>
  </div>
</section><section class="series-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/series">series</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/series/kh%C3%B3a-h%E1%BB%8Dc-python-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Kh√≥a H·ªçc Python CƒÉn B·∫£n">
            Kh√≥a H·ªçc Python CƒÉn B·∫£n<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/series/kh%C3%B3a-h%E1%BB%8Dc-c&#43;&#43;-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Kh√≥a H·ªçc C&#43;&#43; CƒÉn B·∫£n">
            Kh√≥a H·ªçc C&#43;&#43; CƒÉn B·∫£n<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/series/machine-learning-dataset/" class="badge rounded post-taxonomy" title="Machine Learning Dataset">
            Machine Learning Dataset<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/series/ch%E1%BB%A9ng-kho%C3%A1n-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Ch·ª©ng Kho√°n CƒÉn B·∫£n">
            Ch·ª©ng Kho√°n CƒÉn B·∫£n<span class="badge badge-sm text-white bg-accent ms-1">1</span></a></div>
      </div>
    </section><section class="tools-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/tools">tools</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/tools/tool-random/" class="badge rounded post-taxonomy" title="Tool Random">
            Tool Random<span class="badge badge-sm text-white bg-accent ms-1">2</span></a></div>
      </div>
    </section><section class="categories-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/categories">categories</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/categories/python/" class="badge rounded post-taxonomy" title="Python">
            Python<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/categories/c&#43;&#43;/" class="badge rounded post-taxonomy" title="C&#43;&#43;">
            C&#43;&#43;<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/categories/dataset/" class="badge rounded post-taxonomy" title="Dataset">
            Dataset<span class="badge badge-sm text-white bg-accent ms-1">2</span></a></div>
      </div>
    </section><section class="tags-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/tags">tags</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/tags/machine-learning/" class="badge rounded post-taxonomy" title="Machine Learning">
            Machine Learning<span class="badge badge-sm text-white bg-accent ms-1">45</span></a><a href="/tags/deep-learning/" class="badge rounded post-taxonomy" title="Deep Learning">
            Deep Learning<span class="badge badge-sm text-white bg-accent ms-1">21</span></a><a href="/tags/deeplearning/" class="badge rounded post-taxonomy" title="DeepLearning">
            DeepLearning<span class="badge badge-sm text-white bg-accent ms-1">21</span></a><a href="/tags/python/" class="badge rounded post-taxonomy" title="Python">
            Python<span class="badge badge-sm text-white bg-accent ms-1">11</span></a><a href="/tags/opencv/" class="badge rounded post-taxonomy" title="Opencv">
            Opencv<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/tags/c&#43;&#43;/" class="badge rounded post-taxonomy" title="C&#43;&#43;">
            C&#43;&#43;<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/marketing/" class="badge rounded post-taxonomy" title="Marketing">
            Marketing<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/normalization/" class="badge rounded post-taxonomy" title="Normalization">
            Normalization<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/object-detector/" class="badge rounded post-taxonomy" title="Object Detector">
            Object Detector<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/recommendation/" class="badge rounded post-taxonomy" title="Recommendation">
            Recommendation<span class="badge badge-sm text-white bg-accent ms-1">4</span></a></div>
      </div>
    </section>
    
  </div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><ul class="nav justify-content-between footer-memu mb-3"><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Support
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-github"></i>Repository
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer"><i class="fas fa-fw fa-comments"></i>Discussions
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/contact/"><i class="fas fa-fw fa-info-circle"></i>Contact Us
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/faq/"><i class="fas fa-fw fa-question-circle"></i>FAQs
</a>
        </li></ul></li><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Docs
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="/team_of_services" target="_blank" rel="noopener noreferrer"><i class="fas fa-fw fa-users"></i>ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/privacy" target="_blank" rel="noopener noreferrer"><i class="fas fa-fw fa-lock"></i>Ch√≠nh s√°ch b·∫£o m·∫≠t
</a>
        </li></ul></li><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Features
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.phamduytung.com/utils/gen_paswords/" target="_blank" rel="noopener noreferrer"><i class="fas fa-fw fa-paw"></i>T·∫°o password ng·∫´u nhi√™n
</a>
        </li></ul></li><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Li√™n k·∫øt kh√°c
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Netlify
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">facebook
</a>
        </li></ul></li></ul>
<div class="copyright mb-2">
  Copyright ¬© 2016-2025 Ph·∫°m Duy T√πng. All Rights Reserved.
</div>
<div class="powered-by mb-2">
  Website chia s·∫ª ki·∫øn th·ª©c c·ªßa Ph·∫°m Duy T√πng v√† ƒê·∫∑ng Th·ªã H·∫±ng. Vui l√≤ng li√™n h·ªá email alexblack2202@gmail.com n·∫øu b·∫°n c√≥ th√¥ng tin c·∫ßn trao ƒë·ªïi.
</div></footer>
<script src="/js/main.ed2053ad82a243b263761567b5c1aaf974487aa84adacb89ae3ddf803ecc248a.js" integrity="sha256-7SBTrYKiQ7JjdhVntcGq&#43;XRIeqhK2suJrj3fgD7MJIo=" crossorigin="anonymous" defer></script><script src="/js/icons.min.8ff200851002b8138e6b35314683092e02edc155465d9dbfb7d115460f8f1fbe.js" integrity="sha256-j/IAhRACuBOOazUxRoMJLgLtwVVGXZ2/t9EVRg&#43;PH74=" crossorigin="anonymous" defer></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('\/service-worker.js').then(function(reg) {
      console.log('Successfully registered service worker', reg);
    }).catch(function(err) {
      console.warn('Error whilst registering service worker', err);
    });
  });
}
</script><script src="/js/viewer.min.ec58d2aa1a8916addf393be975fdf0070e8c872b0caef1673cb9f7eea067ce57.js" integrity="sha256-7FjSqhqJFq3fOTvpdf3wBw6MhysMrvFnPLn37qBnzlc=" crossorigin="anonymous" defer></script><script defer src="/js/katex.min.d5052035160facae59b60000106771baf2eb7671123813d21f1097a5a9218b6e.js" integrity="sha256-1QUgNRYPrK5ZtgAAEGdxuvLrdnESOBPSHxCXpakhi24=" crossorigin="anonymous"></script>

<script  data-ad-client="ca-pub-4644989745435991"  async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4644989745435991"
     crossorigin="anonymous"></script><script data-cfasync="false" type="text/javascript" data-adel="atag" src="//acscdn.com/script/atg.js" czid="eul3gyjdmm"></script>
  </body>
</html>
