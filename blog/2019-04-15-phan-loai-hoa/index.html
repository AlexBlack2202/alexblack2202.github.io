<!doctype html><html lang="en" data-palette="blue"
   data-mode="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Phân loại hoa sử dụng pretrain model - Phạm Duy Tùng Machine Learning Blog</title>
    <meta name="a.validate.02" content="1QZXZ8oi7g57H-GxBrBPkTYBydwii-Ic9iJu" /><link rel="apple-touch-icon" href="/images/icons/icon-180x180.png" sizes="180x180">
<link rel="icon" href="/images/icons/icon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/images/icons/icon-16x16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/images/icons/favicon.ico">
<link rel="manifest" href="/manifest.json">
<meta name="keywords" content="" />
<meta name="description" content="Ở bài viết này, chúng ta sẽ sử dụng pretrain model của kares để phân loại hoa hồng (rose), hoa mặt trời (sunflower), hoa bồ công anh (dandelion), hoa cúc (daisy) và hoa tulip." /><meta name="robots" content="index, follow" /><meta itemprop="name" content="Phân loại hoa sử dụng pretrain model">
<meta itemprop="description" content="Ở bài viết này, chúng ta sẽ sử dụng pretrain model của kares để phân loại hoa hồng (rose), hoa mặt trời (sunflower), hoa bồ công anh (dandelion), hoa cúc (daisy) và hoa tulip."><meta itemprop="datePublished" content="2019-04-15T00:19:00+03:00" />
<meta itemprop="dateModified" content="2019-04-15T00:19:00+03:00" />
<meta itemprop="wordCount" content="2508">
<meta itemprop="keywords" content="Machine learning,Deeplearning,hoa hồng,hoa mặt trời,hoa bồ công anh,hoa cúc,hoa tulip," /><meta property="og:title" content="Phân loại hoa sử dụng pretrain model" />
<meta property="og:description" content="Ở bài viết này, chúng ta sẽ sử dụng pretrain model của kares để phân loại hoa hồng (rose), hoa mặt trời (sunflower), hoa bồ công anh (dandelion), hoa cúc (daisy) và hoa tulip." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2019-04-15-phan-loai-hoa/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2019-04-15T00:19:00+03:00" />
<meta property="article:modified_time" content="2019-04-15T00:19:00+03:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Phân loại hoa sử dụng pretrain model"/>
<meta name="twitter:description" content="Ở bài viết này, chúng ta sẽ sử dụng pretrain model của kares để phân loại hoa hồng (rose), hoa mặt trời (sunflower), hoa bồ công anh (dandelion), hoa cúc (daisy) và hoa tulip."/>
<meta property="og:image" content="/images/logo.png"/>
  <meta name="twitter:image" content="/images/logo.png"/><link rel="stylesheet" href="/css/main.min.c06cf34535ee1f60ba08893b4d57e76b2bbd5e11c17ab12ef976f02983a51b54.css" integrity="sha256-wGzzRTXuH2C6CIk7TVfnayu9XhHBerEu&#43;XbwKYOlG1Q=" crossorigin="anonymous"><link rel="stylesheet" href="/css/katex.min.d080a89e03e1eb850f547d835c186b4273f69879aa497eb8b0e88c1578bf1f0b.css" integrity="sha256-0ICongPh64UPVH2DXBhrQnP2mHmqSX64sOiMFXi/Hws=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/viewer.min.3d228794bcedbbfa0412beb8fbc1ec6973202945e42af7004f742a4d7bd620ab.css" integrity="sha256-PSKHlLztu/oEEr64&#43;8HsaXMgKUXkKvcAT3QqTXvWIKs=" crossorigin="anonymous"></head>
  <body><script>const items=["mode","palette"];items.forEach(function(e){const t=localStorage.getItem("hbs-"+e);t&&document.body.parentElement.setAttribute("data-"+e,t)})</script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button><a class="navbar-brand flex-grow-1 flex-lg-grow-0 text-center text-lg-start mx-auto me-lg-3" href="/"><img class="logo" alt="Logo" src="/images/logo.webp" loading="lazy"  title="Logo"
   width="400" height="400"
   />
HOME
    </a>
    <div class="offcanvas offcanvas-bottom surface" tabindex="-1" id="offcanvasSocialShare" aria-labelledby="offcanvasSocialShare">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Share</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=Ph%c3%a2n%20lo%e1%ba%a1i%20hoa%20s%e1%bb%ad%20d%e1%bb%a5ng%20pretrain%20model&url=%2fblog%2f2019-04-15-phan-loai-hoa%2f">
      <i class="fab fa-fw fa-twitter"></i> Twitter
    </a>
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button"
      target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=%2fblog%2f2019-04-15-phan-loai-hoa%2f">
      <i class="fab fa-fw fa-facebook-f"></i> Facebook
    </a>
  </div>
</div>
    <button class="navbar-settings" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSettings"
  aria-controls="offcanvasSettings" aria-label="Toggle settings">
  <i class="fas fa-ellipsis-v"></i>
</button>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings" aria-labelledby="offcanvasSettings">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Settings</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body d-flex flex-column">



<section class="setting">
  <form class="font-size-switcher-form row">
    <div class="col-auto">
      <label for="fontSize" class="form-label"><i class="fas fa-fw fa-font"></i> Font Size</label>
    </div>
    <div class="col-auto ms-auto">
      <input type="range" class="form-range" min="-2" max="2" id="fontSize">
    </div>
  </form>
</section>


<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <a id="btnPalette" class="btn btn-sm btn-outline-primary" role="button" aria-label="palettePicker">
        <i class="fas fa-eye-dropper"></i>
      </a>
    </div>
  </form>
  <div class="mt-2 d-flex justify-content-between visually-hidden" id="palettePicker"><button type="button" id="palette-blue" aria-label="Blue"
        class="btn btn-sm w-100 palette" data-palette="blue">
      </button><button type="button" id="palette-blue-gray" aria-label="Blue Gray"
        class="btn btn-sm w-100 palette" data-palette="blue-gray">
      </button><button type="button" id="palette-brown" aria-label="Brown"
        class="btn btn-sm w-100 palette" data-palette="brown">
      </button><button type="button" id="palette-cyan" aria-label="Cyan"
        class="btn btn-sm w-100 palette" data-palette="cyan">
      </button><button type="button" id="palette-green" aria-label="Green"
        class="btn btn-sm w-100 palette" data-palette="green">
      </button><button type="button" id="palette-indigo" aria-label="Indigo"
        class="btn btn-sm w-100 palette" data-palette="indigo">
      </button><button type="button" id="palette-orange" aria-label="Orange"
        class="btn btn-sm w-100 palette" data-palette="orange">
      </button><button type="button" id="palette-pink" aria-label="Pink"
        class="btn btn-sm w-100 palette" data-palette="pink">
      </button><button type="button" id="palette-purple" aria-label="Purple"
        class="btn btn-sm w-100 palette" data-palette="purple">
      </button><button type="button" id="palette-red" aria-label="Red"
        class="btn btn-sm w-100 palette" data-palette="red">
      </button><button type="button" id="palette-teal" aria-label="Teal"
        class="btn btn-sm w-100 palette" data-palette="teal">
      </button><button type="button" id="palette-yellow" aria-label="Yellow"
        class="btn btn-sm w-100 palette" data-palette="yellow">
      </button></div>
</section>
<section class="setting actions d-flex justify-content-around mt-auto overflow-auto">
  <a role="button" class="action action-go-back" href="javascript: window.history.back();">
    <span class="action-icon"><i class="fas fa-2x fa-arrow-left"></i></span> Go back
  </a>
  <a role="button" class="action action-reload-page">
    <span class="action-icon"><i class="fas fa-2x fa-redo-alt"></i></span> Reload
  </a>
  <a role="button" class="action action-copy-url">
    <span class="action-icon"><i class="fas fa-2x fa-link"></i></span> Copy URL
  </a><a class="action action-social-share" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSocialShare"
    aria-controls="offcanvasSocialShare" aria-label="Toggle social share">
    <span class="action-icon"><i class="fas fa-2x fa-share-alt"></i></span> Share
  </a></section>

</div>
</div>

    <div class="collapse navbar-collapse" tabindex="-1" id="navbarSupportedContent" aria-labelledby="navbarSupportedContent">
      <form class="search-bar my-1" action="/search">
  <div class="input-group input-group-sm">
    <span class="btn btn-search disabled position-absolute left-0"><i class="fas fa-fw fa-search"></i></span>
    <input class="form-control rounded-pill" name="q" type="search" aria-label="Search">
  </div>
</form>
      <ul class="navbar-nav ms-auto"><li class="nav-item">
          <a class="nav-link" href="/series/">
            <i class="fas fa-fw fa-columns"></i>Courses
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tools/">
            <i class="fas fa-fw fa-folder"></i>Tools
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/categories/">
            <i class="fas fa-fw fa-folder"></i>Categories
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/archives/">
            <i class="fas fa-fw fa-file-archive"></i>Archives
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tags/">
            <i class="fas fa-fw fa-tags"></i>Tags
          </a>
        </li><li class="nav-item dropdown">
          <a class="nav-link" id="navbarDropdownSupport" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-fw fa-chevron-circle-down"></i>Support
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownSupport"><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Repository
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Discussions
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Features Request
              </a>
            </li><li><hr class="dropdown-divider"></li><li>
              <a class="dropdown-item"
                href="/faq/">
                FAQs
              </a>
            </li></ul>
        </li></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body">
    <ol class="breadcrumb "><li class="breadcrumb-item"><a href="/">Home</a></li><li class="breadcrumb-item"><a href="/blog/">Blogs</a></li><li class="breadcrumb-item active">Phân Loại Hoa Sử Dụng Pretrain Model</li></ol>
  </div>
</nav>
<div class="post-panel-wrapper">
  <div class="d-flex flex-column component rounded post-panel">
    
    <a class="action action-panel-toggler" role="button" title="Panel toggler">
      <i class="fas fa-fw fa-chevron-circle-down"></i>
    </a>
    <a id="sidebarToggler" class="action d-none d-lg-block" role="button" title="Sidebar toggler">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>

    

    
    
    <a class="action" href="#post-comments" role="button" aria-label="Comments" title="Comments">
  <i class="fas fa-fw fa-comments"></i>
</a>
    <a class="action" href="#postTOC" aria-controls="Table of contents" role="button" title="Table of contents">
  <i class="fas fa-fw fa-list-alt"></i>
</a>
    
  </div>
</div>
<article class="row card component mb-4 post">
  <div class="card-header ">
    <h1 class="card-title post-title">Phân Loại Hoa Sử Dụng Pretrain Model
</h1>
  </div>
  <div class="card-body"><div class="post-meta">
  <span class="post-date" title="created on 2019-04-15 04:19:00 &#43;0700 &#43;07.">
    Apr 15, 2019
  </span><span class="post-reading-time">
    12 min read
  </span><span class="post-taxonomies"><a href="/tags/machine-learning/" class="badge post-taxonomy">Machine learning</a><a href="/tags/deeplearning/" class="badge post-taxonomy">Deeplearning</a><a href="/tags/hoa-h%E1%BB%93ng/" class="badge post-taxonomy">hoa hồng</a><a href="/tags/hoa-m%E1%BA%B7t-tr%E1%BB%9Di/" class="badge post-taxonomy">hoa mặt trời</a><a href="/tags/hoa-b%E1%BB%93-c%C3%B4ng-anh/" class="badge post-taxonomy">hoa bồ công anh</a><a href="/tags/hoa-c%C3%BAc/" class="badge post-taxonomy">hoa cúc</a><a href="/tags/hoa-tulip/" class="badge post-taxonomy">hoa tulip</a></span>
</div>
<div class="post-content mb-3">
      
      <img data-original="/thumbnails/flower-classifition.jpg" style="max-height:450px;width: 100%;
      cursor: pointer;
      max-width: 100%;" src="/thumbnails/flower-classifition.jpg" alt="Phân loại hoa sử dụng pretrain model"   />

      <h2 id="lời-mở-đầu">Lời mở đầu<a class="anchor ms-1" href="#lời-mở-đầu"><i class="fas fa-link"></i></a></h2>
<p>Ở trong bài viết này, chúng ta sẽ sử dụng tập dữ liệu là tập dữ liệu ở ở link <a href="https://www.kaggle.com/alxmamaev/flowers-recognition" target="_blank" rel="noopener noreferrer">https://www.kaggle.com/alxmamaev/flowers-recognition</a>. Tập dữ liệu này bao gồm 4242 hình cảnh của 5 loại  hoa hồng (rose), hoa mặt trời (sunflower), hoa bồ công anh (dandelion), hoa cúc (daisy) và hoa tulip. Nhóm tác giả đã thu thập dữ liệu dựa trên các trang web  flicr, google images, yandex. Tập hình ảnh được chia thành 5 lớp, mỗi lớp có khoảng 800 hình, có kích thước xấp xỉ 320x320 pixel. Các hình ảnh có kích thước không đồng nhất với nhau.</p>
<h2 id="thực-hiện">Thực hiện<a class="anchor ms-1" href="#thực-hiện"><i class="fas fa-link"></i></a></h2>
<p>Dữ liệu sau khi giản nén có dạng</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">data_dir</span><span class="o">/</span><span class="n">classname1</span><span class="o">/*.*</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">data_dir</span><span class="o">/</span><span class="n">classname2</span><span class="o">/*.*</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="o">...</span>
</span></span></code></pre></div><p>Cấu trúc lưu trũ như này đúng với mô hình của mình nên chúng ta cần nên chúng ta không thay đổi gì về câu trúc nữa, tiến hành viết code</p>
<p>Đầu tiên, chúng ta sẽ load dataset lên và tranform nó để đưa vào huấn luyện.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="kn">import</span> <span class="nn">scipy.misc</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="k">def</span> <span class="nf">preprocess_input</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">/</span> <span class="mf">255.</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">x</span> <span class="o">-=</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="n">x</span> <span class="o">*=</span> <span class="mf">2.</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="k">def</span> <span class="nf">reverse_preprocess_input</span><span class="p">(</span><span class="n">x0</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">/</span> <span class="mf">2.0</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="n">x</span> <span class="o">+=</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="n">x</span> <span class="o">*=</span> <span class="mf">255.</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">return</span> <span class="n">x</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="k">def</span> <span class="nf">dataset</span><span class="p">(</span><span class="n">base_dir</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;base dir: &#34;</span><span class="o">+</span><span class="n">base_dir</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;n: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">    <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">subdirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">base_dir</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="k">assert</span> <span class="n">file_path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_dir</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="n">suffix</span> <span class="o">=</span> <span class="n">file_path</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">base_dir</span><span class="p">):]</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl">            <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">            <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">            <span class="k">if</span><span class="p">(</span><span class="n">suffix</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">):</span> <span class="c1">#linux</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">                <span class="n">label</span> <span class="o">=</span> <span class="n">suffix</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;/&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">            <span class="k">else</span><span class="p">:</span> <span class="c1">#window</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">                <span class="n">label</span> <span class="o">=</span> <span class="n">suffix</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">            <span class="n">d</span><span class="p">[</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;walk directory complete&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">    <span class="n">tags</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl">    <span class="n">processed_image_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl">    <span class="n">useful_image_count</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="ln">49</span><span class="cl">
</span></span><span class="line"><span class="ln">50</span><span class="cl">    <span class="k">for</span> <span class="n">class_index</span><span class="p">,</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tags</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">51</span><span class="cl">        <span class="n">filenames</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">class_name</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">53</span><span class="cl">            <span class="n">processed_image_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">54</span><span class="cl">            <span class="k">if</span> <span class="n">processed_image_count</span><span class="o">%</span><span class="mi">100</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="n">class_name</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">process: &#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">processed_image_count</span><span class="p">)</span><span class="o">+</span><span class="s2">&#34;</span><span class="se">\t</span><span class="s2">&#34;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">class_name</span><span class="p">])))</span>
</span></span><span class="line"><span class="ln">56</span><span class="cl">            <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">57</span><span class="cl">            <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">chan</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">            <span class="k">assert</span> <span class="n">chan</span> <span class="o">==</span> <span class="mi">3</span>
</span></span><span class="line"><span class="ln">59</span><span class="cl">            <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">)))</span> <span class="o">/</span> <span class="nb">min</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">60</span><span class="cl">            <span class="k">if</span> <span class="n">aspect_ratio</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">61</span><span class="cl">                <span class="k">continue</span>
</span></span><span class="line"><span class="ln">62</span><span class="cl">            <span class="c1"># We pick the largest center square.</span>
</span></span><span class="line"><span class="ln">63</span><span class="cl">            <span class="n">centery</span> <span class="o">=</span> <span class="n">height</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="ln">64</span><span class="cl">            <span class="n">centerx</span> <span class="o">=</span> <span class="n">width</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="ln">65</span><span class="cl">            <span class="n">radius</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="n">centerx</span><span class="p">,</span> <span class="n">centery</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">66</span><span class="cl">            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="n">centery</span><span class="o">-</span><span class="n">radius</span><span class="p">:</span><span class="n">centery</span><span class="o">+</span><span class="n">radius</span><span class="p">,</span> <span class="n">centerx</span><span class="o">-</span><span class="n">radius</span><span class="p">:</span><span class="n">centerx</span><span class="o">+</span><span class="n">radius</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">67</span><span class="cl">            <span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">imresize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">interp</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">68</span><span class="cl">            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">69</span><span class="cl">            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_index</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">70</span><span class="cl">            <span class="n">useful_image_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="ln">71</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;processed </span><span class="si">%d</span><span class="s2">, used </span><span class="si">%d</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">processed_image_count</span><span class="p">,</span> <span class="n">useful_image_count</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">72</span><span class="cl">
</span></span><span class="line"><span class="ln">73</span><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">74</span><span class="cl">    <span class="c1">#X = X.transpose((0, 3, 1, 2))</span>
</span></span><span class="line"><span class="ln">75</span><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="n">preprocess_input</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">76</span><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">77</span><span class="cl">
</span></span><span class="line"><span class="ln">78</span><span class="cl">    <span class="n">perm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">79</span><span class="cl">    <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">80</span><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">perm</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">81</span><span class="cl">
</span></span><span class="line"><span class="ln">82</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;classes:&#34;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">83</span><span class="cl">    <span class="k">for</span> <span class="n">class_index</span><span class="p">,</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tags</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">84</span><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">class_index</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s2">&#34; &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">85</span><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;X shape: &#34;</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">86</span><span class="cl">
</span></span><span class="line"><span class="ln">87</span><span class="cl">    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tags</span>
</span></span></code></pre></div><p>Đoạn code trên khá đơn giản và dễ hiểu. Lưu ý ở đây là với những bức ảnh có tỷ lệ width và height &gt; 2 thì mình sẽ loại chúng ra khỏi tập dữ liệu.</p>
<p>Tiếp theo, chúng ta sẽ xây dựng mô hình dựa trên mô hình Resnet50 có sẵn của kares, do sử dụng pretrain model, nên n-1 lớp trước đó sẽ không được huấn luyện và chúng ta sẽ sử dụng dụng các weight có sẵn đã được huấn luyện trên tập ImageNet rút đặc trưng cho mô hình. Chúng ta chỉ cần thêm một lớp full connected và softmax để phân lớp các loại hoa, công việc của chúng ta hiện tại là tìm ra trọng số của lớp full connected cuối cùng (thay vì huấn luyện lại hết toàn bộ mô hình).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># create the base pre-trained model</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">nb_classes</span><span class="p">):</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="n">base_model</span> <span class="o">=</span> <span class="n">ResNet50</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="s1">&#39;imagenet&#39;</span><span class="p">,</span> <span class="n">include_top</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="c1"># add a global spatial average pooling layer</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">base_model</span><span class="o">.</span><span class="n">output</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">GlobalAveragePooling2D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="c1"># let&#39;s add a fully-connected layer</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="n">x</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="c1"># and a logistic layer</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">    <span class="n">predictions</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">nb_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    <span class="c1"># this is the model we will train</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">base_model</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">predictions</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">    <span class="c1"># first: train only the top layers (which were randomly initialized)</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">    <span class="c1"># i.e. freeze all convolutional ResNet50 layers</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">    <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">base_model</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="n">layer</span><span class="o">.</span><span class="n">trainable</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="k">return</span> <span class="n">model</span>
</span></span></code></pre></div><p>Visualize một chút xíu về kiến trúc inceptionV3 mình đang dùng.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln">  1</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">  2</span><span class="cl"><span class="n">Layer</span> <span class="p">(</span><span class="nb">type</span><span class="p">)</span>                    <span class="n">Output</span> <span class="n">Shape</span>         <span class="n">Param</span> <span class="c1">#     Connected to</span>
</span></span><span class="line"><span class="ln">  3</span><span class="cl"><span class="o">==================================================================================================</span>
</span></span><span class="line"><span class="ln">  4</span><span class="cl"><span class="n">input_1</span> <span class="p">(</span><span class="n">InputLayer</span><span class="p">)</span>            <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">0</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">  6</span><span class="cl"><span class="n">conv1_pad</span> <span class="p">(</span><span class="n">ZeroPadding2D</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span> <span class="mi">0</span>           <span class="n">input_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">  8</span><span class="cl"><span class="n">conv1</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>                  <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">9472</span>        <span class="n">conv1_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">  9</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl"><span class="n">bn_conv1</span> <span class="p">(</span><span class="n">BatchNormalization</span><span class="p">)</span>   <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">conv1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 11</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 12</span><span class="cl"><span class="n">activation_1</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn_conv1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 13</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl"><span class="n">pool1_pad</span> <span class="p">(</span><span class="n">ZeroPadding2D</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">activation_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 15</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl"><span class="n">max_pooling2d_1</span> <span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">)</span>  <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">pool1_pad</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 17</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 18</span><span class="cl"><span class="n">res2a_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">4160</span>        <span class="n">max_pooling2d_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 19</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl"><span class="n">bn2a_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">res2a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl"><span class="n">activation_2</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn2a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 23</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 24</span><span class="cl"><span class="n">res2a_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">36928</span>       <span class="n">activation_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 25</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl"><span class="n">bn2a_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">res2a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 27</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl"><span class="n">activation_3</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn2a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 29</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl"><span class="n">res2a_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">16640</span>       <span class="n">activation_3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 31</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 32</span><span class="cl"><span class="n">res2a_branch1</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">16640</span>       <span class="n">max_pooling2d_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 33</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl"><span class="n">bn2a_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res2a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 35</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl"><span class="n">bn2a_branch1</span> <span class="p">(</span><span class="n">BatchNormalizatio</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res2a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 37</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 38</span><span class="cl"><span class="n">add_1</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn2a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">                                                                 <span class="n">bn2a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 41</span><span class="cl"><span class="n">activation_4</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">add_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 42</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl"><span class="n">res2b_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">16448</span>       <span class="n">activation_4</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 45</span><span class="cl"><span class="n">bn2b_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">res2b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl"><span class="n">activation_5</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn2b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 49</span><span class="cl"><span class="n">res2b_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">36928</span>       <span class="n">activation_5</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl"><span class="n">bn2b_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">res2b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 53</span><span class="cl"><span class="n">activation_6</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn2b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 54</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 55</span><span class="cl"><span class="n">res2b_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">16640</span>       <span class="n">activation_6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 57</span><span class="cl"><span class="n">bn2b_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res2b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 58</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 59</span><span class="cl"><span class="n">add_2</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn2b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">                                                                 <span class="n">activation_4</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 61</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl"><span class="n">activation_7</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">add_2</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 63</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl"><span class="n">res2c_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">16448</span>       <span class="n">activation_7</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 65</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl"><span class="n">bn2c_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">res2c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 67</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 68</span><span class="cl"><span class="n">activation_8</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn2c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 69</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl"><span class="n">res2c_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">36928</span>       <span class="n">activation_8</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 71</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 72</span><span class="cl"><span class="n">bn2c_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">256</span>         <span class="n">res2c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 73</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl"><span class="n">activation_9</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>       <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">6</span> <span class="mi">0</span>           <span class="n">bn2c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 75</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl"><span class="n">res2c_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">16640</span>       <span class="n">activation_9</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl"><span class="n">bn2c_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res2c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl"><span class="n">add_3</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn2c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">                                                                 <span class="n">activation_7</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 82</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl"><span class="n">activation_10</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">add_3</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 84</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl"><span class="n">res3a_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">32896</span>       <span class="n">activation_10</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 86</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl"><span class="n">bn3a_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 88</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl"><span class="n">activation_11</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 90</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl"><span class="n">res3a_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">147584</span>      <span class="n">activation_11</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl"><span class="n">bn3a_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 94</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl"><span class="n">activation_12</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 96</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl"><span class="n">res3a_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">66048</span>       <span class="n">activation_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 98</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln"> 99</span><span class="cl"><span class="n">res3a_branch1</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">131584</span>      <span class="n">activation_10</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">100</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl"><span class="n">bn3a_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res3a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">102</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl"><span class="n">bn3a_branch1</span> <span class="p">(</span><span class="n">BatchNormalizatio</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res3a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">104</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl"><span class="n">add_4</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn3a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">106</span><span class="cl">                                                                 <span class="n">bn3a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">108</span><span class="cl"><span class="n">activation_13</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">add_4</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">110</span><span class="cl"><span class="n">res3b_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">65664</span>       <span class="n">activation_13</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl"><span class="n">bn3b_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">113</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl"><span class="n">activation_14</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">115</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">116</span><span class="cl"><span class="n">res3b_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">147584</span>      <span class="n">activation_14</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">118</span><span class="cl"><span class="n">bn3b_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">120</span><span class="cl"><span class="n">activation_15</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">121</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">122</span><span class="cl"><span class="n">res3b_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">66048</span>       <span class="n">activation_15</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl"><span class="n">bn3b_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res3b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl"><span class="n">add_5</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn3b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">127</span><span class="cl">                                                                 <span class="n">activation_13</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">129</span><span class="cl"><span class="n">activation_16</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">add_5</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl"><span class="n">res3c_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">65664</span>       <span class="n">activation_16</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl"><span class="n">bn3c_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">134</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl"><span class="n">activation_17</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">136</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl"><span class="n">res3c_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">147584</span>      <span class="n">activation_17</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">138</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl"><span class="n">bn3c_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">140</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">141</span><span class="cl"><span class="n">activation_18</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">142</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">143</span><span class="cl"><span class="n">res3c_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">66048</span>       <span class="n">activation_18</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">145</span><span class="cl"><span class="n">bn3c_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res3c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">146</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl"><span class="n">add_6</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn3c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">148</span><span class="cl">                                                                 <span class="n">activation_16</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">149</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">150</span><span class="cl"><span class="n">activation_19</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">add_6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">151</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">152</span><span class="cl"><span class="n">res3d_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">65664</span>       <span class="n">activation_19</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">154</span><span class="cl"><span class="n">bn3d_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3d_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">155</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">156</span><span class="cl"><span class="n">activation_20</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3d_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">158</span><span class="cl"><span class="n">res3d_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">147584</span>      <span class="n">activation_20</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">159</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">160</span><span class="cl"><span class="n">bn3d_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">512</span>         <span class="n">res3d_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">161</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">162</span><span class="cl"><span class="n">activation_21</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn3d_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">163</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">164</span><span class="cl"><span class="n">res3d_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">66048</span>       <span class="n">activation_21</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">165</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">166</span><span class="cl"><span class="n">bn3d_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res3d_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">167</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">168</span><span class="cl"><span class="n">add_7</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn3d_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">169</span><span class="cl">                                                                 <span class="n">activation_19</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">170</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">171</span><span class="cl"><span class="n">activation_22</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">add_7</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">172</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">173</span><span class="cl"><span class="n">res4a_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">131328</span>      <span class="n">activation_22</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">174</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">175</span><span class="cl"><span class="n">bn4a_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">176</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">177</span><span class="cl"><span class="n">activation_23</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">178</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">179</span><span class="cl"><span class="n">res4a_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">590080</span>      <span class="n">activation_23</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">180</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">181</span><span class="cl"><span class="n">bn4a_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">182</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">183</span><span class="cl"><span class="n">activation_24</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">184</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">185</span><span class="cl"><span class="n">res4a_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">263168</span>      <span class="n">activation_24</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">186</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">187</span><span class="cl"><span class="n">res4a_branch1</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">525312</span>      <span class="n">activation_22</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">188</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">189</span><span class="cl"><span class="n">bn4a_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">190</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">191</span><span class="cl"><span class="n">bn4a_branch1</span> <span class="p">(</span><span class="n">BatchNormalizatio</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">192</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">193</span><span class="cl"><span class="n">add_8</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn4a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">194</span><span class="cl">                                                                 <span class="n">bn4a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">195</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">196</span><span class="cl"><span class="n">activation_25</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">add_8</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">197</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">198</span><span class="cl"><span class="n">res4b_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">262400</span>      <span class="n">activation_25</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">199</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">200</span><span class="cl"><span class="n">bn4b_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">201</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">202</span><span class="cl"><span class="n">activation_26</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">203</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">204</span><span class="cl"><span class="n">res4b_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">590080</span>      <span class="n">activation_26</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">205</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">206</span><span class="cl"><span class="n">bn4b_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">207</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">208</span><span class="cl"><span class="n">activation_27</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">209</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">210</span><span class="cl"><span class="n">res4b_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">263168</span>      <span class="n">activation_27</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">211</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">212</span><span class="cl"><span class="n">bn4b_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">213</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">214</span><span class="cl"><span class="n">add_9</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                     <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn4b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">215</span><span class="cl">                                                                 <span class="n">activation_25</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">216</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">217</span><span class="cl"><span class="n">activation_28</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">add_9</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">218</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">219</span><span class="cl"><span class="n">res4c_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">262400</span>      <span class="n">activation_28</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">220</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">221</span><span class="cl"><span class="n">bn4c_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">222</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">223</span><span class="cl"><span class="n">activation_29</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">224</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">225</span><span class="cl"><span class="n">res4c_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">590080</span>      <span class="n">activation_29</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">226</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">227</span><span class="cl"><span class="n">bn4c_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">228</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">229</span><span class="cl"><span class="n">activation_30</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">230</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">231</span><span class="cl"><span class="n">res4c_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">263168</span>      <span class="n">activation_30</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">232</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">233</span><span class="cl"><span class="n">bn4c_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">234</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">235</span><span class="cl"><span class="n">add_10</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn4c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">236</span><span class="cl">                                                                 <span class="n">activation_28</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">237</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">238</span><span class="cl"><span class="n">activation_31</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">add_10</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">239</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">240</span><span class="cl"><span class="n">res4d_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">262400</span>      <span class="n">activation_31</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">241</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">242</span><span class="cl"><span class="n">bn4d_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4d_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">243</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">244</span><span class="cl"><span class="n">activation_32</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4d_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">245</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">246</span><span class="cl"><span class="n">res4d_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">590080</span>      <span class="n">activation_32</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">247</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">248</span><span class="cl"><span class="n">bn4d_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4d_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">249</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">250</span><span class="cl"><span class="n">activation_33</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4d_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">251</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">252</span><span class="cl"><span class="n">res4d_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">263168</span>      <span class="n">activation_33</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">253</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">254</span><span class="cl"><span class="n">bn4d_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4d_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">255</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">256</span><span class="cl"><span class="n">add_11</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn4d_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">257</span><span class="cl">                                                                 <span class="n">activation_31</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">258</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">259</span><span class="cl"><span class="n">activation_34</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">add_11</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">260</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">261</span><span class="cl"><span class="n">res4e_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">262400</span>      <span class="n">activation_34</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">262</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">263</span><span class="cl"><span class="n">bn4e_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4e_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">264</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">265</span><span class="cl"><span class="n">activation_35</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4e_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">266</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">267</span><span class="cl"><span class="n">res4e_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">590080</span>      <span class="n">activation_35</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">268</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">269</span><span class="cl"><span class="n">bn4e_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4e_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">270</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">271</span><span class="cl"><span class="n">activation_36</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4e_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">272</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">273</span><span class="cl"><span class="n">res4e_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">263168</span>      <span class="n">activation_36</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">274</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">275</span><span class="cl"><span class="n">bn4e_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4e_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">276</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">277</span><span class="cl"><span class="n">add_12</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn4e_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">278</span><span class="cl">                                                                 <span class="n">activation_34</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">279</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">280</span><span class="cl"><span class="n">activation_37</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">add_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">281</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">282</span><span class="cl"><span class="n">res4f_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">262400</span>      <span class="n">activation_37</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">283</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">284</span><span class="cl"><span class="n">bn4f_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4f_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">285</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">286</span><span class="cl"><span class="n">activation_38</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4f_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">287</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">288</span><span class="cl"><span class="n">res4f_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">590080</span>      <span class="n">activation_38</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">289</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">290</span><span class="cl"><span class="n">bn4f_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1024</span>        <span class="n">res4f_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">291</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">292</span><span class="cl"><span class="n">activation_39</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn4f_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">293</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">294</span><span class="cl"><span class="n">res4f_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">263168</span>      <span class="n">activation_39</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">295</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">296</span><span class="cl"><span class="n">bn4f_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">4096</span>        <span class="n">res4f_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">297</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">298</span><span class="cl"><span class="n">add_13</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">bn4f_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">299</span><span class="cl">                                                                 <span class="n">activation_37</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">300</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">301</span><span class="cl"><span class="n">activation_40</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="n">add_13</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">302</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">303</span><span class="cl"><span class="n">res5a_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">524800</span>      <span class="n">activation_40</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">304</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">305</span><span class="cl"><span class="n">bn5a_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res5a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">306</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">307</span><span class="cl"><span class="n">activation_41</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn5a_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">308</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">309</span><span class="cl"><span class="n">res5a_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2359808</span>     <span class="n">activation_41</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">310</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">311</span><span class="cl"><span class="n">bn5a_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res5a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">312</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">313</span><span class="cl"><span class="n">activation_42</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn5a_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">314</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">315</span><span class="cl"><span class="n">res5a_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1050624</span>     <span class="n">activation_42</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">316</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">317</span><span class="cl"><span class="n">res5a_branch1</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">2099200</span>     <span class="n">activation_40</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">318</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">319</span><span class="cl"><span class="n">bn5a_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">8192</span>        <span class="n">res5a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">320</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">321</span><span class="cl"><span class="n">bn5a_branch1</span> <span class="p">(</span><span class="n">BatchNormalizatio</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">8192</span>        <span class="n">res5a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">322</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">323</span><span class="cl"><span class="n">add_14</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn5a_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">324</span><span class="cl">                                                                 <span class="n">bn5a_branch1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">325</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">326</span><span class="cl"><span class="n">activation_43</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">add_14</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">327</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">328</span><span class="cl"><span class="n">res5b_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">1049088</span>     <span class="n">activation_43</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">329</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">330</span><span class="cl"><span class="n">bn5b_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res5b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">331</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">332</span><span class="cl"><span class="n">activation_44</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn5b_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">333</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">334</span><span class="cl"><span class="n">res5b_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2359808</span>     <span class="n">activation_44</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">335</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">336</span><span class="cl"><span class="n">bn5b_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res5b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">337</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">338</span><span class="cl"><span class="n">activation_45</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn5b_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">339</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">340</span><span class="cl"><span class="n">res5b_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1050624</span>     <span class="n">activation_45</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">341</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">342</span><span class="cl"><span class="n">bn5b_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">8192</span>        <span class="n">res5b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">343</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">344</span><span class="cl"><span class="n">add_15</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn5b_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">345</span><span class="cl">                                                                 <span class="n">activation_43</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">346</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">347</span><span class="cl"><span class="n">activation_46</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">add_15</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">348</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">349</span><span class="cl"><span class="n">res5c_branch2a</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">1049088</span>     <span class="n">activation_46</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">350</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">351</span><span class="cl"><span class="n">bn5c_branch2a</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res5c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">352</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">353</span><span class="cl"><span class="n">activation_47</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn5c_branch2a</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">354</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">355</span><span class="cl"><span class="n">res5c_branch2b</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2359808</span>     <span class="n">activation_47</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">356</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">357</span><span class="cl"><span class="n">bn5c_branch2b</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">2048</span>        <span class="n">res5c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">358</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">359</span><span class="cl"><span class="n">activation_48</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">5</span> <span class="mi">0</span>           <span class="n">bn5c_branch2b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">360</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">361</span><span class="cl"><span class="n">res5c_branch2c</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>         <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">1050624</span>     <span class="n">activation_48</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">362</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">363</span><span class="cl"><span class="n">bn5c_branch2c</span> <span class="p">(</span><span class="n">BatchNormalizati</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">8192</span>        <span class="n">res5c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">364</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">365</span><span class="cl"><span class="n">add_16</span> <span class="p">(</span><span class="n">Add</span><span class="p">)</span>                    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">bn5c_branch2c</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">366</span><span class="cl">                                                                 <span class="n">activation_46</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">367</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">368</span><span class="cl"><span class="n">activation_49</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>      <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">2</span> <span class="mi">0</span>           <span class="n">add_16</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">369</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">370</span><span class="cl"><span class="n">global_average_pooling2d_1</span> <span class="p">(</span><span class="n">Glo</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)</span>         <span class="mi">0</span>           <span class="n">activation_49</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">371</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">372</span><span class="cl"><span class="n">dense_1</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>                 <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>         <span class="mi">2098176</span>     <span class="n">global_average_pooling2d_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">373</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span><span class="line"><span class="ln">374</span><span class="cl"><span class="n">dense_2</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>                 <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>            <span class="mi">5125</span>        <span class="n">dense_1</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="ln">375</span><span class="cl"><span class="o">==================================================================================================</span>
</span></span><span class="line"><span class="ln">376</span><span class="cl"><span class="n">Total</span> <span class="n">params</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span><span class="mi">691</span><span class="p">,</span><span class="mi">013</span>
</span></span><span class="line"><span class="ln">377</span><span class="cl"><span class="n">Trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">301</span>
</span></span><span class="line"><span class="ln">378</span><span class="cl"><span class="n">Non</span><span class="o">-</span><span class="n">trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span><span class="mi">587</span><span class="p">,</span><span class="mi">712</span>
</span></span><span class="line"><span class="ln">379</span><span class="cl"><span class="n">__________________________________________________________________________________________________</span>
</span></span></code></pre></div><p>Phần train lại sẽ có khoảng hơn 2 triệu tham số, phần layer ở trước đó không train là khoảng 23 triệu tham số.</p>
<p>Chia tập dữ liệu ra thành 5 phần, 4 phần làm tập train, 1 phần làm tập validation.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">tags</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="n">data_directory</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">nb_classes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="n">sample_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="n">train_size</span> <span class="o">=</span> <span class="n">sample_count</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">//</span> <span class="mi">5</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">Y_train</span> <span class="o">=</span> <span class="n">np_utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">nb_classes</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">X_test</span>  <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">y_test</span>  <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="n">Y_test</span> <span class="o">=</span> <span class="n">np_utils</span><span class="o">.</span><span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">nb_classes</span><span class="p">)</span>
</span></span></code></pre></div><p>chúng ta tiến hành thực hiện ImageDataGenerator để có được nhiều dữ liệu mẫu hơn và chống overfit, trong keras đã có sẵn hàm</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">        <span class="n">featurewise_center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">        <span class="n">samplewise_center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">        <span class="n">featurewise_std_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        <span class="n">samplewise_std_normalization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        <span class="n">zca_whitening</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="n">rotation_range</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        <span class="n">width_shift_range</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="n">height_shift_range</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="n">horizontal_flip</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="n">vertical_flip</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="n">channel_shift_range</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="n">zoom_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="n">brightness_range</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="n">fill_mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="n">datagen</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</span></span></code></pre></div><p>Cuối cùng, chúng ta sẽ xây dựng mô hình và tiến hành huấn luyện, lưu mô hình. Quá trình này tốn hơi nhiều thời gian.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="ln"> 1</span><span class="cl">
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">model</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">build_model</span><span class="p">(</span><span class="n">nb_classes</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;accuracy&#34;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># train the model on the new data for a few epochs</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;training the newly added dense layers&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="n">samples_per_epoch</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="n">batch_size</span><span class="o">*</span><span class="n">batch_size</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="n">steps_per_epoch</span> <span class="o">=</span> <span class="n">samples_per_epoch</span><span class="o">//</span><span class="n">batch_size</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="n">validation_steps</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="n">batch_size</span><span class="o">*</span><span class="n">batch_size</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="n">model</span><span class="o">.</span><span class="n">fit_generator</span><span class="p">(</span><span class="n">datagen</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="n">samples_per_epoch</span><span class="o">=</span><span class="n">samples_per_epoch</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="n">epochs</span><span class="o">=</span><span class="n">nb_epoch</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">            <span class="n">steps_per_epoch</span> <span class="o">=</span> <span class="n">steps_per_epoch</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="n">validation_data</span><span class="o">=</span><span class="n">datagen</span><span class="o">.</span><span class="n">flow</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">),</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="n">validation_steps</span><span class="o">=</span><span class="n">validation_steps</span><span class="p">,</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="n">net</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">tags</span><span class="p">,</span> <span class="n">model_file_prefix</span><span class="p">)</span>
</span></span></code></pre></div><p>Thử download một vài hình ảnh trên mạng về rồi test thử xem sao</p>
<p>![Hình ảnh] (flower-classifition_demo.jpg)</p>
<p>Kết quả khá tốt phải không các bạn.</p>
<p>Cảm ơn các bạn đã theo dõi. Hẹn gặp bạn ở các bài viết tiếp theo.</p>
</div></div>
  <div class="card-footer"><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev">
    <i class="fas fa-fw fa-chevron-left"></i>
    <a href="/blog/2019-04-17-walmart-store-sales-forecasting/">Dự Đoán Doanh Số Bán Của Các Cửa Hàng Walmart
</a>
  </div><div class="post-nav post-next">
    <a href="/blog/2019-04-19-deep-learning-view/">Phân Nhóm Các Thuật Toán Học Máy
</a>
    <i class="fas fa-fw fa-chevron-right"></i>
  </div></div></div>
</article><div class="card component row post-comments" id="post-comments">
  <div class="card-header">
    <h2 class="card-title">Comments</h2>
  </div>
  <div class="card-body"><script src="https://utteranc.es/client.js"
  repo="AlexBlack2202/utterances"
  issue-term="pathname"
  label="comment"
  theme="github-dark"
  crossorigin="anonymous"
  async>
</script></div>
</div></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container d-flex flex-column">
    
    <section class="card row text-center profile component">
  <div class="card-body">
    <div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="Đặng Thị Hằng | Phạm Duy Tùng" src="/images/profile.webp" loading="lazy"  title="Đặng Thị Hằng | Phạm Duy Tùng"
   width="736" height="920"
   />
</div>
    <div class="col-12 profile-meta"><div class="profile-name">Đặng Thị Hằng | Phạm Duy Tùng</div><div class="profile-bio">Gopher, CShaper, Pythoner, Full Stack Engineer.</div><div class="profile-company"><i class="fas fa-fw fa-building"></i>MWG</div><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i>Earth</div><div class="profile-about"><i class="fas fa-fw fa-user"></i><a href="/about/">About</a></div><div class="profile-contact"><i class="fas fa-fw fa-question-circle"></i><a href="/contact/">Contact Us</a></div>
</div>
  </div>
</section>
  <div class="post-toc row mb-4 card component" id="postTOC">
  <div class="card-header">
    <h2 class="card-title">Contents</h2>
  </div>
  <div class="card-body">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#lời-mở-đầu">Lời mở đầu</a></li>
        <li><a href="#thực-hiện">Thực hiện</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div><section class="recent-posts row card component">
  <div class="card-header">
    <h2 class="card-title">Recent Posts</h2>
  </div>
  <div class="card-body">
    <ul class="post-list"><li>
        <a href="/blog/2022-12-03-marketing-with-python/">Marketing Thực Chiến - Phân Loại Khách Hàng Sử Dụng RFM Analysis
</a>
      </li><li>
        <a href="/blog/2022-12-01-tiktok-recommendation/">Tiktok Real Time Recommendation
</a>
      </li><li>
        <a href="/blog/2022-08-02-data-exploration-and-data-visualization/">Data Visualization - Phần 1 - Phân Tích Dữ Liệu Netflix
</a>
      </li><li>
        <a href="/blog/2022-07-31-5-way-open-file/">5 Cách Mở File Trong Python
</a>
      </li><li>
        <a href="/blog/2022-02-25-normalization/">Các Kỹ Thuật Chuẩn Hóa Trong Deep Learning
</a>
      </li></ul>
  </div>
</section><section class="series-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/series">series</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/series/kh%C3%B3a-h%E1%BB%8Dc-python-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Khóa học python căn bản">
            Khóa học python căn bản<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/series/kh%C3%B3a-h%E1%BB%8Dc-c&#43;&#43;-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Khóa học c&#43;&#43; căn bản">
            Khóa học c&#43;&#43; căn bản<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/series/machine-learning-dataset/" class="badge rounded post-taxonomy" title="Machine learning dataset">
            Machine learning dataset<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/series/ch%E1%BB%A9ng-kho%C3%A1n-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Chứng khoán căn bản">
            Chứng khoán căn bản<span class="badge badge-sm text-white bg-accent ms-1">1</span></a></div>
      </div>
    </section><section class="tools-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/tools">tools</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/tools/tool-random/" class="badge rounded post-taxonomy" title="Tool Random">
            Tool Random<span class="badge badge-sm text-white bg-accent ms-1">2</span></a></div>
      </div>
    </section><section class="categories-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/categories">categories</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/categories/python/" class="badge rounded post-taxonomy" title="python">
            python<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/categories/c&#43;&#43;/" class="badge rounded post-taxonomy" title="c&#43;&#43;">
            c&#43;&#43;<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/categories/dataset/" class="badge rounded post-taxonomy" title="dataset">
            dataset<span class="badge badge-sm text-white bg-accent ms-1">2</span></a></div>
      </div>
    </section><section class="tags-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/tags">tags</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/tags/machine-learning/" class="badge rounded post-taxonomy" title="Machine learning">
            Machine learning<span class="badge badge-sm text-white bg-accent ms-1">42</span></a><a href="/tags/deeplearning/" class="badge rounded post-taxonomy" title="Deeplearning">
            Deeplearning<span class="badge badge-sm text-white bg-accent ms-1">20</span></a><a href="/tags/deep-learning/" class="badge rounded post-taxonomy" title="Deep learning">
            Deep learning<span class="badge badge-sm text-white bg-accent ms-1">19</span></a><a href="/tags/python/" class="badge rounded post-taxonomy" title="python">
            python<span class="badge badge-sm text-white bg-accent ms-1">14</span></a><a href="/tags/opencv/" class="badge rounded post-taxonomy" title="opencv">
            opencv<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/tags/c&#43;&#43;/" class="badge rounded post-taxonomy" title="c&#43;&#43;">
            c&#43;&#43;<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/object-detector/" class="badge rounded post-taxonomy" title="object detector">
            object detector<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/alexnet/" class="badge rounded post-taxonomy" title="AlexNet">
            AlexNet<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/tags/d%E1%BB%B1-%C4%91o%C3%A1n/" class="badge rounded post-taxonomy" title="dự đoán">
            dự đoán<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/tags/forecast/" class="badge rounded post-taxonomy" title="forecast">
            forecast<span class="badge badge-sm text-white bg-accent ms-1">3</span></a></div>
      </div>
    </section>
    
  </div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><ul class="nav justify-content-between footer-memu mb-3"><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Support
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-github"></i>Repository
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer"><i class="fas fa-fw fa-comments"></i>Discussions
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Features Request
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Bug Report
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/contact/"><i class="fas fa-fw fa-info-circle"></i>Contact Us
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/faq/"><i class="fas fa-fw fa-question-circle"></i>FAQs
</a>
        </li></ul></li><li class="nav-item"><li class="nav-item">
      <a class="nav-link" target="_blank" rel="noopener noreferrer">Docs
</a>
    </li></li><li class="nav-item"><li class="nav-item">
      <a class="nav-link" target="_blank" rel="noopener noreferrer">Features
</a>
    </li></li><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Demo
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Netlify
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">China
</a>
        </li></ul></li></ul>
<div class="copyright mb-2">
  Copyright © 2016-2023 Phạm Duy Tùng. All Rights Reserved.
</div>
<div class="powered-by mb-2">
  Website chia sẻ kiến thức của Phạm Duy Tùng và Đặng Thị Hằng. Vui lòng liên hệ email alexblack2202@gmail.com nếu bạn có thông tin cần trao đổi.
</div></footer>
<script src="/js/main.ed2053ad82a243b263761567b5c1aaf974487aa84adacb89ae3ddf803ecc248a.js" integrity="sha256-7SBTrYKiQ7JjdhVntcGq&#43;XRIeqhK2suJrj3fgD7MJIo=" crossorigin="anonymous" defer></script><script src="/js/icons.min.acdbd59936764a801998a13fb1741d76453c42dc9aeee26251a97b5a9ff679bb.js" integrity="sha256-rNvVmTZ2SoAZmKE/sXQddkU8Qtya7uJiUal7Wp/2ebs=" crossorigin="anonymous" defer></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('\/service-worker.js').then(function(reg) {
      console.log('Successfully registered service worker', reg);
    }).catch(function(err) {
      console.warn('Error whilst registering service worker', err);
    });
  });
}
</script><script src="/js/viewer.min.7781ba4e24db35cc3033a16118f338140fbb6694360d281e18a5928a4d16d54a.js" integrity="sha256-d4G6TiTbNcwwM6FhGPM4FA&#43;7ZpQ2DSgeGKWSik0W1Uo=" crossorigin="anonymous" defer></script><script defer src="/js/katex.min.94aec2dfcc8c17ad662f39ab866039f0e9705caf6f362b93496f3750d66a9bfe.js" integrity="sha256-lK7C38yMF61mLzmrhmA58OlwXK9vNiuTSW83UNZqm/4=" crossorigin="anonymous"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-114911596-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script data-cfasync="false" type="text/javascript" data-adel="atag" src="//acscdn.com/script/atg.js" czid="eul3gyjdmm"></script>
  </body>
</html>
